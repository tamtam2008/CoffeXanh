{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _Container = _interopRequireDefault(require(\"../../../../../../components/layout/Container\"));\n\nvar _ProductList = _interopRequireDefault(require(\"../../productList/ProductList\"));\n\nvar _popularTab = _interopRequireDefault(require(\"./reducer/popularTab.reducer\"));\n\nvar _reactI18next = require(\"react-i18next\");\n\nvar _popularTab2 = _interopRequireDefault(require(\"./reducer/popularTab.action\"));\n\nvar _reactNative = require(\"react-native\");\n\nvar _ChooseProduct = _interopRequireDefault(require(\"../../productModal/chooseProductModal/ChooseProduct.modal\"));\n\nvar _app = _interopRequireDefault(require(\"../../../../../../redux/app.actions\"));\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _popularTab3 = require(\"./popularTab.controller\");\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\ADMINS\\\\Desktop\\\\GreenApp\\\\CoffeXanh\\\\src\\\\screens\\\\root\\\\menu\\\\components\\\\tabs\\\\PopularTab\\\\PopularTab.js\";\n\nvar PopularTab = function PopularTab(props) {\n  var _useTranslation = (0, _reactI18next.useTranslation)(),\n      t = _useTranslation.t;\n\n  var _useReducer = (0, _react.useReducer)(_popularTab.default.reducer, _popularTab.default.initState),\n      _useReducer2 = (0, _slicedToArray2.default)(_useReducer, 2),\n      state = _useReducer2[0],\n      dispatch = _useReducer2[1];\n\n  var selectedItem = props.selectedItem,\n      closeChooseProductModal = props.closeChooseProductModal,\n      addChooseProduct = props.addChooseProduct,\n      navigation = props.navigation;\n\n  var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n      callRequested = _useState2[0],\n      setCallRequested = _useState2[1];\n\n  (0, _react.useLayoutEffect)(function () {\n    if (!callRequested) {\n      (0, _popularTab3.callGetProducts)(dispatch);\n      setCallRequested(true);\n    }\n  }, [callRequested]);\n  var onRefresh = (0, _react.useCallback)(function () {\n    dispatch({\n      type: _popularTab2.default.GET_DATA\n    });\n    (0, _popularTab3.callGetProducts)(dispatch);\n  }, []);\n  var updateFavorite = (0, _react.useCallback)(function () {\n    dispatch({\n      type: _popularTab2.default.UPDATE_FAVORITE_LIST\n    });\n  }, []);\n  (0, _react.useEffect)(function () {\n    return navigation.addListener('focus', function () {\n      dispatch({\n        type: _popularTab2.default.UPDATE_FAVORITE_LIST\n      });\n    });\n  }, [navigation]);\n  return _react.default.createElement(_Container.default, {\n    contentStyle: _reactNative.StyleSheet.flatten({\n      backgroundColor: '#fff'\n    }),\n    scrollEnabled: false,\n    isLoading: state.isRequesting,\n    isFail: state.isFail || state.productData.length === 0,\n    failMsg: t(state.failMsg || 'Menu.ProductTabs.empty'),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 5\n    }\n  }, _react.default.createElement(_ProductList.default, {\n    productData: state.productData,\n    onRefresh: onRefresh,\n    updateFavorite: updateFavorite,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }\n  }), navigation.isFocused() && _react.default.createElement(_ChooseProduct.default, {\n    id: selectedItem,\n    footerAction: {\n      cancelAction: closeChooseProductModal,\n      submitAction: function submitAction(product) {\n        return addChooseProduct(product);\n      }\n    },\n    updateFavorite: updateFavorite,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }\n  }));\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  var cart = state.cart;\n  return {\n    selectedItem: cart.selectedItem\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    closeChooseProductModal: function closeChooseProductModal() {\n      return dispatch({\n        type: _app.default.CART_SELECT_ITEM,\n        payload: null\n      });\n    },\n    addChooseProduct: function addChooseProduct(product) {\n      return dispatch({\n        type: _app.default.CART_ADD_ITEM,\n        payload: product\n      });\n    }\n  };\n};\n\nvar _default = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps)(PopularTab);\n\nexports.default = _default;","map":{"version":3,"sources":["C:/Users/ADMINS/Desktop/GreenApp/CoffeXanh/src/screens/root/menu/components/tabs/PopularTab/PopularTab.js"],"names":["PopularTab","props","t","popularTabReducer","reducer","initState","state","dispatch","selectedItem","closeChooseProductModal","addChooseProduct","navigation","callRequested","setCallRequested","onRefresh","type","Actions","GET_DATA","updateFavorite","UPDATE_FAVORITE_LIST","addListener","StyleSheet","flatten","backgroundColor","isRequesting","isFail","productData","length","failMsg","isFocused","cancelAction","submitAction","product","mapStateToProps","cart","mapDispatchToProps","AppActions","CART_SELECT_ITEM","payload","CART_ADD_ITEM"],"mappings":"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","sourcesContent":["import React, {\r\n  useCallback,\r\n  useEffect,\r\n  useLayoutEffect,\r\n  useReducer,\r\n  useState,\r\n} from 'react';\r\nimport Container from '../../../../../../components/layout/Container';\r\nimport ProductList from '../../productList/ProductList';\r\nimport popularTabReducer from './reducer/popularTab.reducer';\r\nimport { useTranslation } from 'react-i18next';\r\nimport Actions from './reducer/popularTab.action';\r\nimport { StyleSheet } from 'react-native';\r\nimport ChooseProductModal from '../../productModal/chooseProductModal/ChooseProduct.modal';\r\nimport AppActions from '../../../../../../redux/app.actions';\r\nimport { connect } from 'react-redux';\r\nimport { callGetProducts } from './popularTab.controller';\r\n\r\nconst PopularTab = props => {\r\n  const { t } = useTranslation();\r\n  const [state, dispatch] = useReducer(\r\n    popularTabReducer.reducer,\r\n    popularTabReducer.initState,\r\n  );\r\n  const {\r\n    selectedItem,\r\n    closeChooseProductModal,\r\n    addChooseProduct,\r\n    navigation,\r\n  } = props;\r\n  const [callRequested, setCallRequested] = useState(false);\r\n\r\n  useLayoutEffect(() => {\r\n    if (!callRequested) {\r\n      callGetProducts(dispatch);\r\n      setCallRequested(true);\r\n    }\r\n  }, [callRequested]);\r\n\r\n  const onRefresh = useCallback(() => {\r\n    dispatch({ type: Actions.GET_DATA });\r\n    callGetProducts(dispatch);\r\n  }, []);\r\n  const updateFavorite = useCallback(() => {\r\n    dispatch({ type: Actions.UPDATE_FAVORITE_LIST });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // Return the function to unsubscribe from the event so it gets removed on unmount\r\n    return navigation.addListener('focus', () => {\r\n      dispatch({ type: Actions.UPDATE_FAVORITE_LIST });\r\n    });\r\n  }, [navigation]);\r\n  return (\r\n    <Container\r\n      contentStyle={StyleSheet.flatten({ backgroundColor: '#fff' })}\r\n      scrollEnabled={false}\r\n      isLoading={state.isRequesting}\r\n      isFail={state.isFail || state.productData.length === 0}\r\n      failMsg={t(state.failMsg || 'Menu.ProductTabs.empty')}>\r\n      <ProductList\r\n        productData={state.productData}\r\n        onRefresh={onRefresh}\r\n        updateFavorite={updateFavorite}\r\n      />\r\n      {navigation.isFocused() && (\r\n        <ChooseProductModal\r\n          id={selectedItem}\r\n          footerAction={{\r\n            cancelAction: closeChooseProductModal,\r\n            submitAction: product => addChooseProduct(product),\r\n          }}\r\n          updateFavorite={updateFavorite}\r\n        />\r\n      )}\r\n    </Container>\r\n  );\r\n};\r\nconst mapStateToProps = state => {\r\n  const { cart } = state;\r\n  return {\r\n    selectedItem: cart.selectedItem,\r\n  };\r\n};\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n    closeChooseProductModal: () =>\r\n      dispatch({ type: AppActions.CART_SELECT_ITEM, payload: null }),\r\n    addChooseProduct: product =>\r\n      dispatch({ type: AppActions.CART_ADD_ITEM, payload: product }),\r\n  };\r\n};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps,\r\n)(PopularTab);\r\n"]},"metadata":{},"sourceType":"script"}